PROP
{
  name = BCS_MAS_StarlinerNarwhal

  MODEL
  {
    model = BCS_Starliner_IVA/Props/BCS_MAS_StarlinerNarwhal
  }

  SHABBY_MATERIAL_REPLACE
  {
    materialDef = BCS_narwhal_Resurfaced
    targetMaterial = BCS_narwhal
  }

  MODULE
  {
    name = MASMonitor

    screenTransform = Plane1
    layer = _MainTex
    screenSize = 512, 512
    fontSize = 32, 64
    font = Press Start K
    style = Bold
    textColor = 0, 255, 0, 255
    backgroundColor = 0, 0, 0, 0
    monitorID = %AUTOID%

    page = MAS_BCS_Narwhal1
  }

  MODULE
  {
    name = MASComponent

    COLOR_SHIFT
    {
      name = Plane
      transform = Plane1
      passiveColor = 0, 0, 0, 0
      activeColor = 255, 255, 255, 255
      blend = true
      colorName = _TintColor
      variable = fc.GetPersistentAsNumber("Global_StartNarwhalAnimation") == 2 and fc.Between(fc.GetPersistentAsNumber("Narwhal_Animation_Frame"), 500, 2722) == 1
    }

    COLLIDER_EVENT
    {
      name = Collider
      collider = NarwhalCollider
      onClick = BCS_NarwhalCounter("%AUTOID%")
      variable = fc.GetPersistentAsNumber("Global_StartNarwhalAnimation") == 0 and fc.GetPersistentAsNumber("Global_VESTA2") == 1
    }

    AUDIO_PLAYER
    {
      name = Audio
      sound = BCS_Starliner_IVA/Props/BCS_MAS_StarlinerNarwhal1
      trigger = ON
      variable = fc.GetPersistentAsNumber("Global_StartNarwhalAnimation") == 1
      mustPlayOnce = true
    }

    AUDIO_PLAYER
    {
      name = Audio
      sound = BCS_Starliner_IVA/Props/BCS_MAS_StarlinerNarwhal2
      trigger = ON
      variable = fc.GetPersistentAsNumber("Global_StartNarwhalAnimation") == 2
      mustPlayOnce = true
    }

    TRANSLATION
    {
      name = Animation
      transform = TransformZ
      startTranslation = 0, 0, 0
      endTranslation = 0, 0.025, 0
      variable = fc.GetPersistentAsNumber("Global_StartNarwhalAnimation") > 0
      blend = true
      speed = 100.0
    }

    TRANSLATION
    {
      name = Animation
      transform = TransformX
      startTranslation = -0.02, 0, 0
      endTranslation = 0.02, 0, 0
      variable = fc.Remap((fc.PeriodSine(8.1)) * fc.Between(fc.GetPersistentAsNumber("Narwhal_Animation_Frame"), 1, 1940) * (fc.GetPersistentAsNumber("Global_StartNarwhalAnimation") == 2), -1, 1, 0, 1)
      blend = true
      speed = 100.0
    }

    TRANSLATION
    {
      name = Animation
      transform = TransformY
      startTranslation = 0, 0, -0.015
      endTranslation = 0, 0, 0.015
      variable = fc.Remap((fc.PeriodSine(3.75)) * fc.Between(fc.GetPersistentAsNumber("Narwhal_Animation_Frame"), 1, 1940) * (fc.GetPersistentAsNumber("Global_StartNarwhalAnimation") == 2), -1, 1, 0, 1)
      blend = true
      speed = 100.0
    }

    TRANSLATION
    {
      name = Animation
      transform = MainTransform
      startTranslation = 0, -0.0125, 0
      endTranslation = 0, 0.0125, 0
      variable = fc.Remap((fc.PeriodSine(6.18)) * fc.Between(fc.GetPersistentAsNumber("Narwhal_Animation_Frame"), 1, 1940) * (fc.GetPersistentAsNumber("Global_StartNarwhalAnimation") == 2), -1, 1, 0, 1)
      blend = true
      speed = 100.0
    }

    ROTATION
    {
      name = Animation
      transform = TransformY
      startRotation = 0, 0, 0
      endRotation = 0, 359, 0
      variable = fc.GetPersistentAsNumber("%AUTOID%_Rotation")
      range = 0.0, 1.0
      blend = true
      longPath = true
      speed = 100.0
    }

    ROTATION
    {
      name = Animation
      transform = LightRotator
      startRotation = 0, 0, 0
      endRotation = 0, 359, 0
      variable = fc.GetPersistentAsNumber("%AUTOID%_LightRotation")
      range = 0.0, 1.0
      blend = true
      longPath = true
      speed = 100.0
    }

    MODEL_SCALE
    {
      name = Animation
      transform = LightRotator
      startScale = 0.2, 0.2, 0.2
      endScale = -0.2, -0.2, -0.2
      variable = fc.Remap(fc.PeriodSine(2), -1, 1, 0, 1)
      blend = true
    }

    MODEL_SCALE
    {
      name = Animation
      transform = MainTransform
      startScale = 0, 0, 0
      endScale = 0.4, 0.4, 0.4
      variable = fc.Remap(fc.GetPersistentAsNumber("Narwhal_Animation_Frame"), 1940, 2722, 0, 1)
      blend = true
    }

    TRIGGER_EVENT
    {
      name = Animator
      event = fc.AddPersistentWrapped("%AUTOID%_Rotation", 0.215, 0, 1)
      exitEvent = fc.SetPersistent("Global_StartNarwhalAnimation", 0 + fc.SetPersistent("%AUTOID%_Rotation", 0))
      variable = fc.GetPersistentAsNumber("Global_StartNarwhalAnimation") == 1 and fc.Between(fc.GetPersistentAsNumber("Narwhal_Animation_Frame"), 1, 91) == 1
      autoRepeat = true
    }

    TRIGGER_EVENT
    {
      name = Animator
      event = fc.AddPersistentWrapped("%AUTOID%_LightRotation", 0.09126, 0, 1)
      variable = fc.GetPersistentAsNumber("Global_StartNarwhalAnimation") == 1 and fc.Between(fc.GetPersistentAsNumber("Narwhal_Animation_Frame"), 1, 91) == 1
      autoRepeat = true
    }

    TRIGGER_EVENT
    {
      name = Animator
      event = fc.AddPersistentWrapped("%AUTOID%_Rotation", 0.215, 0, 1)
      variable = fc.GetPersistentAsNumber("Global_StartNarwhalAnimation") == 2 and fc.Between(fc.GetPersistentAsNumber("Narwhal_Animation_Frame"), 1, 1940) == 1
      autoRepeat = true
    }

    TRIGGER_EVENT
    {
      name = Animator
      event = fc.SetPersistent("%AUTOID%_Rotation", 0.75)
      exitEvent = fc.SetPersistent("Global_StartNarwhalAnimation", 0 + fc.SetPersistent("%AUTOID%_Rotation", 0))
      variable = fc.GetPersistentAsNumber("Global_StartNarwhalAnimation") == 2 and fc.Between(fc.GetPersistentAsNumber("Narwhal_Animation_Frame"), 1940, 2722) == 1
      autoRepeat = true
    }

    TRIGGER_EVENT
    {
      name = Animator
      event = fc.AddPersistentWrapped("%AUTOID%_LightRotation", 0.09126, 0, 1)
      variable = fc.GetPersistentAsNumber("Global_StartNarwhalAnimation") == 2 and fc.Between(fc.GetPersistentAsNumber("Narwhal_Animation_Frame"), 1, 2722) == 1
      autoRepeat = true
    }

    TRIGGER_EVENT
    {
      name = Animator
      event = fc.AddPersistentWrapped("Global_UVAnimator", 0.02, 0, 1)
      variable = fc.GetPersistentAsNumber("Global_StartNarwhalAnimation") == 2 and fc.Between(fc.GetPersistentAsNumber("Narwhal_Animation_Frame"), 1, 2722) == 1
      autoRepeat = true
    }
    //1940
    //2724
    //1420
    //1590
    TRIGGER_EVENT
    {
      name = Animator
      event = fc.AddPersistentClamped("Narwhal_Animation_Frame", 1, 0, 93)
      exitEvent = fc.SetPersistent("Narwhal_Animation_Frame", 0)
      variable = fc.GetPersistentAsNumber("Global_StartNarwhalAnimation") == 1
      autoRepeat = true
    }

    TRIGGER_EVENT
    {
      name = Animator
      event = fc.AddPersistentClamped("Narwhal_Animation_Frame", 1, 0, 2724)
      exitEvent = fc.SetPersistent("Narwhal_Animation_Frame", 0)
      variable = fc.GetPersistentAsNumber("Global_StartNarwhalAnimation") == 2
      autoRepeat = true
    }

    INT_LIGHT
    {
      name = Red
      lightName = RedLight
      color = fc.Remap(fc.PeriodSine(0.28), -1, 1, 0, 255), 0, 0, 255
      intensity = 2
      variable = fc.GetPersistentAsNumber("Global_StartNarwhalAnimation") == 2
    }

    INT_LIGHT
    {
      name = Green
      lightName = GreenLight
      color = 0, fc.Remap(fc.PeriodSine(0.41), -1, 1, 0, 255), 0, 255
      intensity = 2
      variable = fc.GetPersistentAsNumber("Global_StartNarwhalAnimation") == 2
    }

    INT_LIGHT
    {
      name = Blue
      lightName = BlueLight
      color = 0, 0, fc.Remap(fc.PeriodSine(0.56), -1, 1, 0, 255), 255
      intensity = 2
      variable = fc.GetPersistentAsNumber("Global_StartNarwhalAnimation") == 2
    }

    INT_LIGHT
    {
      name = White
      lightName = WhiteLight
      color = 255, 255, 255, 255
      intensity = 8
      variable = fc.GetPersistentAsNumber("Global_StartNarwhalAnimation") == 2 and fc.Between(fc.GetPersistentAsNumber("Narwhal_Animation_Frame"), 2680, 2722)
    }
  }
}

MAS_PAGE
{
  name = MAS_BCS_Narwhal1

  IMAGE
  {
    name = Texture
    texture = BCS_Starliner_IVA/Props/BCS_Narwhal1
    position = 0, 0
    size = 512, 512
    variable = fc.Between(fc.GetPersistentAsNumber("Narwhal_Animation_Frame"), 500, 2722)
    passiveColor = 255, 255, 255, 255
    activeColor = fc.Remap(fc.PeriodSine(2.8456),-1 ,1 , 30, 255), fc.Remap(fc.PeriodSine(5.156),-1 ,1 , 30, 255), fc.Remap(fc.PeriodSine(3.1789),-1 ,1 , 30, 255), 255
    colorVariable = fc.Between(fc.GetPersistentAsNumber("Narwhal_Animation_Frame"), 500, 2722)
    colorBlend = false
    uvShift = 0 + fc.GetPersistentAsNumber("Global_UVAnimator"), 0
    wrap = true
  }

  IMAGE
  {
    name = Texture
    texture = BCS_Starliner_IVA/Props/BCS_Narwhal2
    position = 0, 0
    size = 512, 512
    variable = fc.Between(fc.GetPersistentAsNumber("Narwhal_Animation_Frame"), 950, 2722)
    passiveColor = 255, 255, 255, 255
    activeColor = fc.Remap(fc.PeriodSine(4.8456),-1 ,1 , 30, 255), fc.Remap(fc.PeriodSine(1.156),-1 ,1 , 30, 255), fc.Remap(fc.PeriodSine(2.1789),-1 ,1 , 30, 255), 255
    colorVariable = fc.Between(fc.GetPersistentAsNumber("Narwhal_Animation_Frame"), 500, 2722)
    colorBlend = false
    uvShift = 0 + fc.Remap(fc.GetPersistentAsNumber("Global_UVAnimator"), 0, 1, 0, -1), 0
    wrap = true
  }
}